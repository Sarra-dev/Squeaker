{% load static %}
<!-- Sidebar Navigation - Only show if user is authenticated -->
{% if request.user.is_authenticated %}
<div class="sidebar">
    <!-- Logo -->
    <div class="logo">
        <a href="{% url 'home' %}">
            <img src="{% static 'images/logo14.png' %}" 
            width="100%" height="100%"
            alt="Logo" class="logo-img">
        </a>
    </div>

    <!-- Navigation Menu -->
    <nav>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="{% url 'home' %}" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fas fa-search"></i>
                    <span>Explore</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <div style="position: relative;">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <span>Notifications</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fas fa-envelope"></i>
                    <span>Messages</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fas fa-bookmark"></i>
                    <span>Bookmarks</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="{% url 'profile_list' %}" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span>Communities</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fab fa-twitter"></i>
                    <span>Premium</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="{% url 'profile' request.user.pk %}" class="nav-link">
                    <i class="fas fa-user"></i>
                    <span>Profile</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <i class="fas fa-ellipsis-h"></i>
                    <span>More</span>
                </a>
            </li>
        </ul>

        <!-- Post Button -->
        <button class="post-button">Post</button>
    </nav>

    <!-- User Menu -->
    <div class="user-menu">
        <div class="user-info" onclick="toggleUserDropdown()">
            {% if request.user.profile.profile_image %}
                <img src="{{ request.user.profile.profile_image.url }}" alt="{{ request.user.username }}" class="user-avatar">
            {% else %}
                <img src="https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png" alt="{{ request.user.username }}" class="user-avatar">
            {% endif %}
            <div class="user-details">
                <div class="user-name">{{ request.user.get_full_name|default:request.user.username }}</div>
                <div class="user-username">@{{ request.user.username }}</div>
            </div>
            <i class="fas fa-ellipsis-h"></i>
        </div>
        
        <!-- Logout Dropdown -->
        <div class="user-dropdown" id="userDropdown">
            <a href="{% url 'logout' %}" class="dropdown-item">
                <i class="fas fa-sign-out-alt"></i>
                <span>Log out @{{ request.user.username }}</span>
            </a>
        </div>
    </div>
</div>

<script>
function toggleUserDropdown() {
    const dropdown = document.getElementById('userDropdown');
    if (dropdown) {
        dropdown.classList.toggle('show');
    }
}

// Close dropdown when clicking outside
document.addEventListener('click', function(event) {
    const userMenu = document.querySelector('.user-menu');
    const dropdown = document.getElementById('userDropdown');
    
    if (userMenu && dropdown && !userMenu.contains(event.target)) {
        dropdown.classList.remove('show');
    }
});
</script>
{% endif %}